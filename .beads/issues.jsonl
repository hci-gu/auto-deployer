{"id":"auto-deployer-12k","title":"Set up preview-controller main: HTTP server + health/ready routes","description":"Create initial Go app entrypoint with HTTP server, route wiring for /webhook/github, /healthz, /readyz, and graceful shutdown skeleton.","notes":"Scaffolded Go module and preview-controller entrypoint with HTTP server, /webhook/github (POST-only placeholder), /healthz, /readyz, JSON slogging, and graceful shutdown. LISTEN_ADDR env supported with default :8080.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T11:41:00.088469+01:00","updated_at":"2026-01-14T11:41:34.039193+01:00","closed_at":"2026-01-14T11:41:34.039193+01:00"}
{"id":"auto-deployer-6o6","title":"Implement delete on PR closed (label cleanup)","description":"Delete Deployment/Service/Route by labels; optionally delete namespace for per-pr mode.","notes":"Added DeletePreview with label-based DeleteCollection for Deployment/Service/Route and optional namespace delete for per-pr mode. Wired webhook closed action to call DeletePreview with KEEP_ON_MERGE support.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T13:03:26.883088+01:00","updated_at":"2026-01-14T13:04:31.724846+01:00","closed_at":"2026-01-14T13:04:31.724846+01:00"}
{"id":"auto-deployer-7tm","title":"Add deploy manifests + document config","description":"Create OpenShift manifests for controller deployment and document env/config usage in README.","notes":"Added OpenShift deployment manifest (namespace, SA, RBAC, deployment, service, route, configmap) and expanded README with env/config usage and deploy instructions.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T13:04:53.187003+01:00","updated_at":"2026-01-14T13:05:31.823459+01:00","closed_at":"2026-01-14T13:05:31.823459+01:00"}
{"id":"auto-deployer-a72","title":"Define MVP scope and config contract; sketch repo structure","description":"Clarify MVP deliverables and required env/config mapping; propose initial repo layout aligned with implementation_plan.md.","notes":"MVP scope (Milestone 1): HTTP server with POST /webhook/github + GET /healthz + GET /readyz; verify GitHub signature; handle pull_request opened/synchronize/closed; reconcile Deployment+Service+Route in a single namespace; basic JSON logging; in-cluster or token-based OpenShift client.\\nConfig contract (env): GITHUB_WEBHOOK_SECRET, GITHUB_ALLOWED_REPOS (csv), PREVIEW_NAMESPACE_MODE=single, PREVIEW_BASE_NAMESPACE, IMAGE_REF_TEMPLATE, IMAGE_TAG_STRATEGY (sha|pr|pr-sha), ROUTE_DOMAIN_TEMPLATE, DEFAULT_CONTAINER_PORT=8080, LOG_LEVEL (optional), OPENSHIFT_API_URL/OPENSHIFT_TOKEN optional for out-of-cluster.\\nConfig mapping: file (YAML or JSON) under /config/app-mapping.(yaml|json) with repo full_name â†’ {appName, containerPort, env, resources, routePath, healthCheckPath}.\\nRepo sketch: /cmd/preview-controller/main.go; /internal/github (signature+event parsing), /internal/reconcile (desired state + apply), /internal/openshift (client + Route types), /config (mapping), /deploy (controller manifests).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T11:40:38.401808+01:00","updated_at":"2026-01-14T11:40:50.022197+01:00","closed_at":"2026-01-14T11:40:50.022197+01:00"}
{"id":"auto-deployer-cit","title":"Implement GitHub webhook verification + pull_request event parsing","description":"Add HMAC signature verification for X-Hub-Signature-256 and parse pull_request payloads for action/repo/pr fields.","notes":"Added internal/github package with HMAC signature verification (X-Hub-Signature-256), pull_request payload types, and JSON parsing. Updated main webhook handler to verify signature, parse pull_request events, and log core fields.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T11:42:21.066016+01:00","updated_at":"2026-01-14T11:43:06.462669+01:00","closed_at":"2026-01-14T11:43:06.462669+01:00"}
{"id":"auto-deployer-dee","title":"Add allowed repo filtering + optional fork rejection","description":"Validate repository.full_name against GITHUB_ALLOWED_REPOS and optionally reject fork PRs via config toggle.","notes":"Added allowed repo parsing + gating via GITHUB_ALLOWED_REPOS; added optional fork rejection toggle via GITHUB_REJECT_FORKS=true; webhook handler now forbids unlisted repos and fork PRs when enabled.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T11:43:26.84384+01:00","updated_at":"2026-01-14T11:44:02.586228+01:00","closed_at":"2026-01-14T11:44:02.586228+01:00"}
{"id":"auto-deployer-dxc","title":"Implement reconcile create/update for Deployment/Service/Route (single namespace)","description":"Add desired resource builders + apply logic to create/update preview resources in single namespace mode.","notes":"Added reconcile PreviewConfig, resource builders (Deployment/Service/Route) with labels/annotations, and UpsertPreview flow. Implemented client apply logic to create/update Deployment, Service, and Route with basic service field preservation.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T12:58:19.544175+01:00","updated_at":"2026-01-14T13:00:19.858257+01:00","closed_at":"2026-01-14T13:00:19.858257+01:00"}
{"id":"auto-deployer-hzt","title":"Investigate preview reconcile failed: client rate limiter Wait context canceled","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T09:38:30.711532+01:00","updated_at":"2026-01-15T10:06:27.397379+01:00","closed_at":"2026-01-15T10:06:27.397379+01:00","comments":[{"id":1,"issue_id":"auto-deployer-hzt","author":"sebastianandreasson","text":"Likely cause: request context is canceled before reconcile. In cmd/preview-controller/main.go, reconcile uses context.WithTimeout(r.Context(), 2*time.Minute) after the image build (can take minutes). If the webhook client/proxy times out, r.Context() is canceled, and client-go rate limiter returns context canceled. Suggest decoupling reconcile from request context (use context.Background() or async/queue + early 202).","created_at":"2026-01-15T08:39:12Z"},{"id":2,"issue_id":"auto-deployer-hzt","author":"sebastianandreasson","text":"Implemented async preview job queue with worker(s). Webhook now enqueues build/reconcile/delete and responds 202; workers run build/reconcile with background context + timeouts, avoiding request context cancellation. Added PREVIEW_QUEUE_SIZE and PREVIEW_WORKERS envs, default 20 and 1.","created_at":"2026-01-15T08:41:45Z"}]}
{"id":"auto-deployer-tzz","title":"Post PR comment with preview link after deployment","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T10:07:48.301735+01:00","updated_at":"2026-01-15T10:09:02.197877+01:00","closed_at":"2026-01-15T10:09:02.197877+01:00"}
{"id":"auto-deployer-wq7","title":"Implement image/tag template rendering + naming conventions","description":"Render image refs from IMAGE_REF_TEMPLATE and IMAGE_TAG_STRATEGY; define consistent naming helpers for resources.","notes":"Added internal/reconcile helpers for image tag strategy, template rendering, and naming/namespace derivation. Added unit tests for tag and template rendering.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T11:45:04.615399+01:00","updated_at":"2026-01-14T11:45:41.490097+01:00","closed_at":"2026-01-14T11:45:41.490097+01:00"}
{"id":"auto-deployer-yhq","title":"Audit repo structure, existing code, and config; align with implementation_plan.md milestones","description":"Review current repo layout, existing code, configs, and compare gaps vs implementation_plan.md to inform subsequent tasks.","notes":"Repo currently only contains AGENTS.md, README.md, LICENSE, and implementation_plan.md; no code or config directories yet. We will need to scaffold repo structure per plan (/cmd, /internal, /config, /deploy).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T11:39:57.603099+01:00","updated_at":"2026-01-14T11:40:11.334635+01:00","closed_at":"2026-01-14T11:40:11.334635+01:00"}
{"id":"auto-deployer-z8v","title":"Implement OpenShift client wiring + resource apply scaffolding","description":"Add OpenShift/Kubernetes client setup (in-cluster + token) and stubs for apply/patch of Deployment/Service/Route.","notes":"Added internal/openshift client wiring using client-go (in-cluster or OPENSHIFT_API_URL/OPENSHIFT_TOKEN), dynamic client for Route GVR, and apply stubs for Deployment/Service/Route. Pinned k8s deps to v0.30.3 to keep Go 1.22 compatibility.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T12:53:50.954619+01:00","updated_at":"2026-01-14T12:56:56.791059+01:00","closed_at":"2026-01-14T12:56:56.791059+01:00"}
{"id":"auto-deployer-z9z","title":"Wire webhook handler to reconcile previews with config","description":"Load env config + repo-\u003eapp mapping; derive PreviewConfig; call reconcile UpsertPreview on pull_request opened/synchronize.","notes":"Wired webhook handler to load env config + repo mapping, build PreviewConfig, and call reconcile.UpsertPreview for opened/reopened/synchronize actions. Added mapping loader and env config (DEFAULT_CONTAINER_PORT override). Added sample config/app-mapping.json.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-14T13:00:51.571163+01:00","updated_at":"2026-01-14T13:02:30.911755+01:00","closed_at":"2026-01-14T13:02:30.911755+01:00"}
